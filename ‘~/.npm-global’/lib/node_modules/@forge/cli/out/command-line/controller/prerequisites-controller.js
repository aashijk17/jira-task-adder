"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PrerequisitesController = void 0;
const semver_1 = require("semver");
const cli_shared_1 = require("@forge/cli-shared");
const version_info_1 = require("../version-info");
const getNodeVersion_1 = require("./getNodeVersion");
class PrerequisitesController {
    logger;
    cliDetails;
    constructor(logger, cliDetails) {
        this.logger = logger;
        this.cliDetails = cliDetails;
    }
    async check() {
        await Promise.all([this.checkNodeVersion()]);
    }
    async checkNodeVersion() {
        const userNodeVersion = (0, getNodeVersion_1.getNodeVersion)();
        if (this.cliDetails && !(0, semver_1.satisfies)(userNodeVersion, this.cliDetails.compatibleNodeVersion)) {
            await (0, cli_shared_1.exitOnError)(this.logger, new Error(cli_shared_1.Text.error.outdatedNodeVersion(this.cliDetails.compatibleNodeVersion, userNodeVersion)));
        }
        if (!(0, semver_1.satisfies)(userNodeVersion, version_info_1.semverSupportedNodeVersion)) {
            this.logger.warn(cli_shared_1.Text.warning.unsupportedNodeVersion(userNodeVersion, version_info_1.humanReadableSupportedNodeVersion));
        }
    }
}
exports.PrerequisitesController = PrerequisitesController;
//# sourceMappingURL=prerequisites-controller.js.map