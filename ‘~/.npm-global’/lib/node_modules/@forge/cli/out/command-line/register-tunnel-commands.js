"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.registerCommands = void 0;
const cli_shared_1 = require("@forge/cli-shared");
const registerCommands = async ({ cmd, controllers: { tunnelController }, services: { statsigService } }) => {
    const tunnelCmd = cmd
        .command('tunnel')
        .requireAppId()
        .description(cli_shared_1.Text.tunnel.cmd)
        .environmentOption()
        .option('-d, --debug', cli_shared_1.Text.tunnel.optionDebugger)
        .option('-f,--debugFunctionHandlers <debugFunctionHandlers...>', cli_shared_1.Text.tunnel.functionHandlers)
        .option('-p,--debugStartingPort [debugStartingPort]', cli_shared_1.Text.tunnel.debuggerPort, cli_shared_1.defaultDebugStartingPort.toString())
        .option('-n, --no-verify', 'disable pre-tunnel checks');
    const isSelfManagedTunnelEnabled = await statsigService.isSelfManagedTunnelEnabled();
    if (isSelfManagedTunnelEnabled) {
        tunnelCmd
            .option('-u, --url <url>', cli_shared_1.Text.tunnel.connectUsingSelfManagedTunnel)
            .option('--local-port <localPort>', cli_shared_1.Text.tunnel.tunnelLocalPort);
    }
    tunnelCmd.action(async (options) => {
        await tunnelController.run(options);
    });
};
exports.registerCommands = registerCommands;
//# sourceMappingURL=register-tunnel-commands.js.map