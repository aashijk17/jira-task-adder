"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.RoaService = void 0;
class RoaService {
    getAppConfig;
    roaClient;
    constructor(getAppConfig, roaClient) {
        this.getAppConfig = getAppConfig;
        this.roaClient = roaClient;
    }
    async getEligibilityStatus(environmentKey, majorVersion) {
        const { id: appId } = await this.getAppConfig();
        const data = await this.roaClient.getVersionEligibility(appId, environmentKey, majorVersion);
        return {
            isEligible: !!data.trustSignal?.result,
            reason: data.trustSignal?.rules?.filter((rule) => rule.value) || [],
            appVersion: data.appVersion,
            environmentType: data.environmentType
        };
    }
}
exports.RoaService = RoaService;
//# sourceMappingURL=roa-service.js.map